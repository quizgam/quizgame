<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Snake Game Am√©lior√©</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #0f1724;
      color: #fff;
      height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
    }
    h1 { margin: 10px 0; }
    canvas {
      background: #1a2335;
      border: 2px solid #2f6fbf;
      border-radius: 8px;
    }
    .info {
      margin-top: 10px;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <h1>üêç Snake Am√©lior√©</h1>
  <canvas id="game" width="400" height="400"></canvas>
  <div class="info">Score : <span id="score">0</span></div>

<script>
// === Param√®tres ===
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");

const box = 20;
let snake, direction, food, score, game;

// Images (serpent + papillon)
const headImg = new Image();
headImg.src = "https://i.imgur.com/YZbXcRY.png"; // t√™te serpent
const bodyImg = new Image();
bodyImg.src = "https://i.imgur.com/dyjtZ3N.png"; // corps serpent
const butterflyImg = new Image();
butterflyImg.src = "https://i.imgur.com/GgGqXfF.png"; // papillon

// Sons
const moveSound = new Audio("https://www.soundjay.com/button/beep-07.wav");
const eatSound = new Audio("https://www.soundjay.com/button/beep-08b.wav");

// Initialisation
function initGame() {
  snake = [{ x: 9 * box, y: 10 * box }];
  direction = "RIGHT";
  food = randomFood();
  score = 0;
  scoreEl.textContent = score;
  if (game) clearInterval(game);
  game = setInterval(draw, 120);
}

// G√©n√®re une position al√©atoire pour la nourriture
function randomFood() {
  return {
    x: Math.floor(Math.random() * (canvas.width / box)) * box,
    y: Math.floor(Math.random() * (canvas.height / box)) * box
  };
}

// === Contr√¥les clavier ===
document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft" && direction !== "RIGHT") direction = "LEFT";
  else if (e.key === "ArrowUp" && direction !== "DOWN") direction = "UP";
  else if (e.key === "ArrowRight" && direction !== "LEFT") direction = "RIGHT";
  else if (e.key === "ArrowDown" && direction !== "UP") direction = "DOWN";
});

// === Contr√¥les tactiles ===
let touchStartX = 0, touchStartY = 0;
canvas.addEventListener("touchstart", e => {
  const touch = e.touches[0];
  touchStartX = touch.clientX;
  touchStartY = touch.clientY;
});
canvas.addEventListener("touchend", e => {
  const touch = e.changedTouches[0];
  let dx = touch.clientX - touchStartX;
  let dy = touch.clientY - touchStartY;

  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 0 && direction !== "LEFT") direction = "RIGHT";
    else if (dx < 0 && direction !== "RIGHT") direction = "LEFT";
  } else {
    if (dy > 0 && direction !== "UP") direction = "DOWN";
    else if (dy < 0 && direction !== "DOWN") direction = "UP";
  }
});

// Dessiner le jeu
function draw() {
  ctx.fillStyle = "#0f1724";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Dessiner la nourriture (papillon)
  ctx.drawImage(butterflyImg, food.x, food.y, box, box);

  // Dessiner le serpent
  for (let i = 0; i < snake.length; i++) {
    let part = snake[i];
    if (i === 0) {
      ctx.drawImage(headImg, part.x, part.y, box, box);
    } else {
      ctx.drawImage(bodyImg, part.x, part.y, box, box);
    }
  }

  // Calcul nouvelle position de la t√™te
  let snakeX = snake[0].x;
  let snakeY = snake[0].y;

  if (direction === "LEFT") snakeX -= box;
  if (direction === "UP") snakeY -= box;
  if (direction === "RIGHT") snakeX += box;
  if (direction === "DOWN") snakeY += box;

  // Bordures (t√©l√©portation)
  if (snakeX < 0) snakeX = canvas.width - box;
  if (snakeY < 0) snakeY = canvas.height - box;
  if (snakeX >= canvas.width) snakeX = 0;
  if (snakeY >= canvas.height) snakeY = 0;

  // Manger le papillon
  if (snakeX === food.x && snakeY === food.y) {
    score++;
    scoreEl.textContent = score;
    food = randomFood();
    eatSound.play();
  } else {
    snake.pop();
  }

  const newHead = { x: snakeX, y: snakeY };

  // Collision avec soi-m√™me
  if (collision(newHead, snake)) {
    clearInterval(game);
    alert("üíÄ Game Over! Score final : " + score);
    initGame();
    return;
  }

  snake.unshift(newHead);
  moveSound.play();
}

function collision(head, array) {
  return array.some(part => head.x === part.x && head.y === part.y);
}

initGame();
</script>
</body>
</html>
